(()=>{"use strict";const e=(e,t,n,a,c)=>({title:e,description:t,priority:n,dueDate:a,isDone:c}),t=(()=>{const t=[],n=()=>{localStorage.setItem("itemArray",JSON.stringify(t))};return(()=>{const e=JSON.parse(localStorage.getItem("itemArray"));e&&Array.isArray(e)&&(t.length=0,t.push(...e))})(),{itemArray:t,createItem:(a,c,o,r,i)=>{const l=e(a,c,o,r,i);return t.push(l),n(),l},deleteItem:e=>{const a=t.indexOf(e);a>-1&&(t.splice(a,1),n())},editItem:async(e,t,a,c,o,r)=>{e.title=t,e.description=a,e.priority=c,e.dueDate=new Date(o),e.isDone=r,n()},toggleIsDone:e=>{e.isDone=!e.isDone,n()},getAllItems:()=>t}})(),n=(()=>{const t=[],a=()=>{localStorage.setItem("projectArray",JSON.stringify(t))};return(()=>{const e=JSON.parse(localStorage.getItem("projectArray"));e&&Array.isArray(e)&&(t.length=0,t.push(...e))})(),{projectArray:t,createProject:e=>{const n=((e,t=[])=>({title:e,array:t}))(e,[]);return t.push(n),a(),n},deleteProject:e=>{const n=t.indexOf(e);n>-1&&(t.splice(n,1),a())},editProject:(e,t)=>{e.title=t,a()},addProjectItem:(t,n,c,o,r,i)=>{const l=e(n,c,o,r,i);return t.array.push(l),a(),l},deleteProjectItem:(e,t)=>{const n=e.array.indexOf(t);n>-1&&(e.array.splice(n,1),a())},getAllProjects:()=>t,getProjectByTitle:e=>n.getAllProjects().find((t=>t.title===e))}})(),a=(()=>{const e=e=>{const t=new Date;t.setHours(0,0,0,0);const n=new Date(e);return n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear()},a=e=>{const t=new Date;t.setHours(0,0,0,0);const n=new Date(Date.parse(e)),a=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-t.getDay()));return n>=t&&n<=a};return{isDueToday:e,isDueThisWeek:a,getAllDailyItems:()=>{const a=[],c=[...t.itemArray];return n.projectArray.forEach((e=>{c.push(...e.array)})),c.forEach((t=>{e(t.dueDate)&&a.push(t)})),a},getAllWeeklyItems:()=>{const e=[],c=[...t.itemArray];return n.projectArray.forEach((e=>{c.push(...e.array)})),c.forEach((t=>{a(t.dueDate)&&e.push(t)})),e},getAllTotalItems:()=>{const e=[...t.itemArray];return n.projectArray.forEach((t=>{e.push(...t.array)})),e}}})();function c(e,n){const a=document.createElement("form");a.classList.add("form");const c=document.createElement("input");c.type="text",c.name="title",c.value=e.title;const r=document.createElement("textarea");r.name="description",r.value=e.description;const i=document.createElement("select");i.name="priority";const s=document.createElement("option");s.value="low",s.text="Low Priority",i.appendChild(s);const d=document.createElement("option");d.value="medium",d.text="Medium Priority",i.appendChild(d);const m=document.createElement("option");m.value="high",m.text="High Priority",i.appendChild(m),i.value=e.priority;const p=document.createElement("input");p.type="date",p.name="dueDate";const u=e.dueDate instanceof Date?e.dueDate:new Date(e.dueDate);p.value=u.toISOString().slice(0,10);const y=document.createElement("input");y.type="checkbox",y.name="isDone",y.checked=e.isDone;const h=document.createElement("label");h.textContent="Completed",h.appendChild(y);const g=document.createElement("button");return g.type="submit",g.textContent="Update Item",a.appendChild(c),a.appendChild(r),a.appendChild(i),a.appendChild(p),a.appendChild(h),a.appendChild(g),a.addEventListener("submit",(async c=>{c.preventDefault();const r=c.target.elements.title.value,i=c.target.elements.description.value,s=c.target.elements.priority.value,d=new Date(c.target.elements.dueDate.value);d.setHours(0,0,0,0);const m=c.target.elements.isDone.checked;await t.editItem(e,r,i,s,d,m),n.replaceWith(await o(e)),c.target.reset(),a.style.display="none",await l()})),a}async function o(e){if(!t.itemArray.includes(e))return document.createComment("Item not in itemArray");const n=document.createElement("div");n.classList.add("card");const a=document.createElement("div");a.classList.add("left");const o=document.createElement("div");o.classList.add("right");const r=document.createElement("div");r.classList.add("priority"),"low"===e.priority?r.classList.add("low"):"medium"===e.priority?r.classList.add("medium"):"high"===e.priority&&r.classList.add("high");const i=document.createElement("input");i.classList.add("left"),i.type="checkbox",i.checked=e.isDone,i.addEventListener("click",(async()=>{await t.toggleIsDone(e)}));const l=document.createElement("p");l.textContent=e.title;const s=document.createElement("p"),d={day:"numeric",month:"short",year:"2-digit"};if("string"==typeof e.dueDate){const t=new Date(e.dueDate);s.textContent=t.toLocaleDateString("en-US",d)}else s.textContent=e.dueDate.toLocaleDateString("en-US",d);const m=document.createElement("img");m.src="images/edit.png",m.addEventListener("click",(()=>{const t=c(e,n);n.replaceWith(t)}));const p=document.createElement("img");return p.src="images/delete.png",p.addEventListener("click",(async a=>{a.preventDefault(),console.log("Deleting item:",e),await t.deleteItem(e),console.log("Item deleted:",e),console.log("Updated item array:",t.getAllItems()),n.remove()})),a.appendChild(r),a.appendChild(i),a.appendChild(l),n.appendChild(a),o.appendChild(s),o.appendChild(m),o.appendChild(p),n.appendChild(o),n}async function r(e){const a=document.createElement("div");a.classList.add("card");const o=document.createElement("div");o.classList.add("left");const r=document.createElement("div");r.classList.add("right");const i=document.createElement("p");i.textContent=e.title;const l=document.createElement("div");l.classList.add("priority"),"low"===e.priority?l.classList.add("low"):"medium"===e.priority?l.classList.add("medium"):"high"===e.priority&&l.classList.add("high");const s=document.createElement("input");s.classList.add("left"),s.type="checkbox",s.checked=e.isDone,s.addEventListener("click",(async()=>{await t.toggleIsDone(e)}));const d=document.createElement("p"),m={day:"numeric",month:"short",year:"2-digit"};if("string"==typeof e.dueDate){const t=new Date(e.dueDate);d.textContent=t.toLocaleDateString("en-US",m)}else d.textContent=e.dueDate.toLocaleDateString("en-US",m);const p=document.createElement("img");p.src="images/edit.png",p.addEventListener("click",(()=>{const t=c(e,a);a.replaceWith(t)}));const u=document.createElement("img");return u.src="images/delete.png",u.addEventListener("click",(async t=>{t.preventDefault(),console.log("Deleting project item:",e);const c=n.getProjectByTitle(e.title);await n.deleteProjectItem(c,e),console.log("Project item deleted:",e),console.log("Updated project array:",n.getAllProjects()),a.remove()})),o.appendChild(l),o.appendChild(s),o.appendChild(i),a.appendChild(o),r.appendChild(d),r.appendChild(p),r.appendChild(u),a.appendChild(r),a}async function i(e){const t=document.createElement("div");t.classList.add("card");const a=document.createElement("div");a.classList.add("left");const c=document.createElement("div");c.classList.add("right");const o=document.createElement("a");o.href="#",o.textContent=e.title,o.addEventListener("click",(async()=>{document.querySelectorAll("#allItems a").forEach((e=>{e.classList.remove("active")})),document.querySelectorAll("#projectContainer > .card").forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),await d(e)}));const r=document.createElement("img");r.src="images/edit.png",r.addEventListener("click",(()=>{const a=function(e,t){const a=document.createElement("form");a.classList.add("form");const c=document.createElement("input");c.type="text",c.name="title",c.value=e.title;const o=document.createElement("button");return o.type="submit",o.textContent="Update Project",a.appendChild(c),a.appendChild(o),a.addEventListener("submit",(async c=>{c.preventDefault();const o=c.target.elements.title.value;await n.editProject(e,o),t.replaceWith(await i(e)),c.target.reset(),a.style.display="none",await s()})),a}(e,t);t.replaceWith(a)}));const l=document.createElement("img");return l.src="images/delete.png",l.addEventListener("click",(async a=>{a.preventDefault(),await n.deleteProject(e),t.remove()})),a.appendChild(o),c.appendChild(r),c.appendChild(l),t.appendChild(a),t.appendChild(c),t}async function l(){const e=document.querySelector("#content");e.textContent="",document.querySelectorAll(".card").forEach((e=>{e.classList.remove("active")})),document.querySelector("#allItems a:first-child").classList.add("active");const t=await a.getAllTotalItems(),c=await n.getAllProjects();return t.forEach((async t=>{const n=await o(t);e.appendChild(n)})),c.forEach((async t=>{t.array.forEach((async t=>{const n=await r(t);e.appendChild(n)}))})),e}async function s(){const e=document.querySelector("#projectContainer");return e.textContent="",(await n.getAllProjects()).forEach((async t=>{const n=await i(t);e.appendChild(n)})),e}async function d(e){const t=document.querySelector("#content");return t.textContent="",e.array.forEach((async e=>{const n=await r(e);t.appendChild(n)})),t}console.log("This seem to be working..."),async function(e){l(),s();const c=document.querySelectorAll("#allItems a");c.forEach((e=>{e.addEventListener("click",(e=>{c.forEach((e=>{e.classList.remove("active")})),e.target.classList.add("active"),document.querySelectorAll(".card").forEach((e=>{e.classList.remove("active")}))}))})),document.querySelector("#allItems a:first-child").addEventListener("click",(async()=>{await l()})),document.querySelector("#allItems a:nth-child(2)").addEventListener("click",(async()=>{await async function(){const e=document.querySelector("#content");e.textContent="";const t=await a.getAllDailyItems(),c=n.getAllProjects();return t.forEach((async t=>{const n=await o(t);e.appendChild(n)})),c.forEach((async t=>{t.array.forEach((async t=>{const n=await r(t);e.appendChild(n)}))})),e}()})),document.querySelector("#allItems a:nth-child(3)").addEventListener("click",(async()=>{await async function(){const e=document.querySelector("#content");e.textContent="";const t=await a.getAllWeeklyItems(),c=n.getAllProjects();return t.forEach((async t=>{const n=await o(t);e.appendChild(n)})),c.forEach((async t=>{t.array.forEach((async t=>{const n=await r(t);e.appendChild(n)}))})),e}()})),document.querySelector("#newTaskBtn").addEventListener("click",(()=>{!function(){const e=document.querySelector("#content"),a=document.createElement("form");a.classList.add("form");const c=document.createElement("input");c.type="text",c.name="title",c.placeholder="Title",c.required=!0;const o=document.createElement("textarea");o.name="description",o.placeholder="Description";const r=document.createElement("select");r.name="project",n.getAllProjects().forEach((e=>{const t=document.createElement("option");t.value=e.title,t.text=e.title,r.appendChild(t)}));const i=document.createElement("option");i.value="noProject",i.text="No Project",r.appendChild(i);const s=document.createElement("select");s.name="priority";const m=document.createElement("option");m.value="low",m.text="Low Priority",s.appendChild(m);const p=document.createElement("option");p.value="medium",p.text="Medium Priority",s.appendChild(p);const u=document.createElement("option");u.value="high",u.text="High Priority",s.appendChild(u);const y=document.createElement("input");y.type="date",y.name="dueDate",y.required=!0;const h=document.createElement("input");h.type="checkbox",h.name="isDone";const g=document.createElement("label");g.textContent="Completed",g.appendChild(h);const E=document.createElement("button");E.type="submit",E.textContent="Create Item",a.appendChild(c),a.appendChild(o),a.appendChild(r),a.appendChild(s),a.appendChild(y),a.appendChild(g),a.appendChild(E),a.addEventListener("submit",(async e=>{e.preventDefault();const c=e.target.elements.project.value,o=n.getProjectByTitle(c),r=e.target.elements.title.value,i=e.target.elements.description.value,s=e.target.elements.priority.value,m=new Date(e.target.elements.dueDate.value);m.setHours(0,0,0,0);const p=e.target.elements.isDone.checked;"noProject"===c?(await t.createItem(r,i,s,m,p),e.target.reset(),a.style.display="none",await l()):o&&(await n.addProjectItem(o,r,i,s,m,p),e.target.reset(),a.style.display="none",await d(o))})),e.appendChild(a)}()})),document.querySelector("#newProjectBtn").addEventListener("click",(()=>{!function(){const e=document.querySelector("#content"),t=document.createElement("form");t.classList.add("form");const a=document.createElement("input");a.type="text",a.name="title",a.placeholder="Title",a.required=!0;const c=document.createElement("button");c.type="submit",c.textContent="Create Project",t.appendChild(a),t.appendChild(c),t.addEventListener("submit",(e=>{e.preventDefault();const a=e.target.elements.title.value;n.createProject(a),e.target.reset(),t.style.display="none",s()})),e.appendChild(t)}()}))}()})();